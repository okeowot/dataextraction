# NAME: TOLULOPE OKEOWO

# PROJECT DESCRIPTION: THIS PROJECT TAKES IN A URL WHICH IS USUALLY A PDF, EXTRACTS THE DATA FROM THE PDF, MANIPULATES THE DATA AND THE INSERTS THE DATA INTO A DATABASE.

# FUNCTIONS:

# FETCHINCIDENTS(URL): THIS FUNCTION GETS THE VARIOUS INCIDENTS IN THE PDF FILE WHICH WOULD BE GIVEN AS URL AND RETURNS THAT EXTRACTED DATA. I ASSIGNED THE VARIABLE DATA TO  SAVE THE VALUES GOTTEN. I HAVE LABELED THE EXTRACTED DATA AS DATA

# EXTRAINCIDENTS(DATA) : THIS FUNCTION TAKES IN THE DATA FROM FETCHINCIDENTS(URL) AND ASSIGNS IT TO A VARIABLE CALLED LIST_STRINGS. LIST_STRINGS CONTAINS A LIST THAT CONTAINS ALL THE EDITED LINES IN THE PDF FILE. THE FUNCTION FIRST OPENS A NEW FILE CALLED MYFILE.PDF I THEN WRITE THE DATA FROM FETCHINCIDNETS INTO THE NEW PDF FILE. AFTER THIS IS DONE, I USE THE PDFREADER ON MYFILE.PDF TO CONVERT THE DATA FROM THE PDF WEBSITE INTO A READABLE OUTPUT. AFTER THAT, I LOOPED THROUGH THROUGH EACH PAGE, EXTRACT THE TEXT FROM THE PAGE THEN SPLIT THE TEXT IN THE PAGES INTO LINES. AFTER MAKING THE LINES, I THEN APPENDED THOSE LINES INTO LINE_LIST. THIS MAKES IT A LITTLE EASIER TO SEARCH FOR THE DIFFERENT PATTERNS I NEED TO SPLIT UP THE DATA INTO THE PARTS I NEEDED FOR PROJECT. AFTER THAT, I MANIPULATED THE DATA IN LINE_LIST BY USING REGULAR EXPRESSIONS. 2 REGULAR EXPRESSIONS WERE USED IN THIS FUNCTION.  PATTERN1 = r"NORMAN POLICE DEPARTMENT" PATTERN2 = r"Daily" AND PATTERN3 = r"^[a-zA-Z]". PATTERN1 AND PATTERN2 WERE USED TO REMOVE THE HEADER FROM THE DATA SET AND PATTERN3 WAS USED TO FIND THE ADDRESS WITH DOBLE LINES AND THEN REMOVE IT. WHEN IT WAS DONE SORTING, I THEN LOOPED THROUGH THE CORRECTED DATA AND APPENED EACH LINE(SINCE IT HAD BEEN SPLIT INTO LINE EARLIER) INTO LIST_STRINGS. I THEN RETURNED LIST_STRINGS SO IT CAN BE USED IN OUR NEXT FUNCTION.

# CREATEDB(): THIS FUNCTION CREATES A DATABASE WITH TABLE INCIDENTS AND COLUMNS INCIDENT_TIME TEXT, INCIDENT_NUMBER TEXT, INCIDENT_LOCATION TEXT, NATURE TEXT, INCIDENT_ORI TEXT. AFTER THE TABLE IS CREATED THE .COMMIT IS USED TO COMMIT THE TABLE TO THE DATABASE AND .CLOSE IS USED TO CLOSE THE DATABASE. 

# POPULATEDB(INCIDENTS_DB, INCIDENTS): THIS FUNCTION TAKES TWO INPUTS. ONE IS THE DATABASE TO POPULATE WHCIH WAS MADE FROM THE CREATEDB FUNCTION AND THE OTHER IS THE LIST OF INCIDENTS. THE FUNCTION WORKS BY FIRST OF CONNECTING TO THE PATH OF THE DATABASE CREATED(NORMANPD.DB), THEN CONNECTING TO THAT PATH AND THEN A CURSOR TO BE ABLE TO MOVE WITHIN THE RESULT SET OF A QUERY. A REGEX PATTERN WAS USED IN THIS FUNCTION BECAUSE SOME OF THE DATA HAD A / SYMBOL IN IT. (r'^[A-Z][a-z]+(/.*)?$'). THIS WAS USED FOR THE NATURE PART OF THE PDF DOCUMENT. THE NEXT THING WAS TO DIVIDE THE INCIDENTS INTO JUST STRINGS USING .SPLIT(). I WAS ABLE TO USE STRING MANIPULATION AND A FOR LOOP TO GET THE DIFFERENT VALUES FOR THE DIFFERNT SECTIONS IN OUR DATA BASE. AFTER THIS WAS ALL DONE, I STRIPPED AND SPLIT THE STRINGS BACK INTO BEING STRINGS SO THAT THEY WOULD BE INSERTED INTO THE DATABASE. 

# STATUS(): THIS FUNCTION  ASSIGNS A PATH TO THE DATABASE, CONNECTS THE PATH TO SQLITE3 AND THEN A CURSOR IS SET. A VARIABLE PATTERN WAS SET TO THE QUERY "SELECT NATURE, COUNT(*) FROM INCIDENTS GROUP BY NATURE". THIS COMMAND IS USED TO RETRIEVE THE COUNT OF EACH UNIQUE VALUE IN THE NATURE COULUMN OF THE INCIDENTS TABLE. THEN I EXECUTED THE COMMAND. AFTER THAT, I USED THE .FETCHALL() COMMAND TO GET ALL THE VALUES ASSOCITED TO MY QUERY. THEN A FOR COMMAND TO PRINT IT ALL OUT WITH THE | SEPERATION. 

# TEST_CREATEDB(): THIS TEST FUNCTIONS CHECKS TO SEE IF THE DATABASE WAS CREATED. THE FIRST THING WAS THAT THE CREATEDB() FUNCTION WAS CALLED. THEN WE VERIFIED THE TABLE HAS BEEN MADE BY MAKING SURE THE FIRST INDEX IN RESULT ISN'T ZERO. 

# TEST_FI(): THIS IS ALSO ANOTHER TEST FUNCTION THAT CHECKS TO SEE IF THE FUNCTIONINCIDENTS FUNCTION WAS ABLE TO GET THE INCIDENTS FROM THE PDF FILE. IT THEN CHECKS TO MAKE SURE THAT THE DATA WHICH IS A VARIABLE USED ISN'T ZERO.

# HOW DATABASE WAS DEVELOPED: 

# THE DATABASE WAS DEVELOPED USING SQLITE3. I DID A PIP INSTALL SQLITE3 TO GET THE PACKAGES AND THEN IMPORTED IT INTO MY FUNCTIONS.PY. I USED THE CREATEDB() FUNCTION TO CREATE THE DATABASE BY FIRST CREATING A PATH TO THE DATABASE, CONNECTING THE PATH WITH SQLITE3 AND CREATING A CURSOR TO MOVE AROUND THE RESULTS FROM THE QUERY. WHEN I HAD GOTTEN ALL MY DATA THAT NEEDED TO BE INSERTED INTO THE DATABASE, I USED A FOR LOOP FROM 0 TO THE LENGTH OF ONE OF THE VARIABLES TO BE INSERTED. I THEN USED AN EXCUTE COMMAND ON MY CURSOR WITH THE QUERY OF INSERTING INTO THE TABLE INCIDENTS. AFTER THIS, I COMMITTED THE CHANGED INTO THE DATABASE. 

# BUGS AND ASSUMPTION:

# THE BUGS IN MY CODE ARE FROM THE TEST-CASES. I WAS ONLY ABLE TO GET THE TEST CASES FOR FETCHING THE DATA AND CREATING THE DATABASE.THE ASSUMPTIONS MADE WERE GOTTEN FROM THE PATTERNS IN THE DATA. I ASSUMED THAT ACCORDING TO THE DATA, THE FIRST AND SECOND COLUMN WOULD BE THE DATE AND TIME IN THE PDF, THE THIRD COLUMN WAS ASSUMED TO ALWAYS BE THE INCIDENT NUMBER AND THE LAST COLUMN IN THE PDF WOULD BE THE INCIDENT ORI. 

# HOW TO INSTALL:

# PIPENV RUN PYTHON MAIN.PY --INCIDENTS HTTPS://WWW.NORMANOK.GOV/SITES/DEFAULT/FILES/DOCUMENTS/2023-02/2023-02-22_DAILY_INCIDENT_SUMMARY.PDF

# THE PACKAGES I USED WERE RE, ARGPARSE, URLIB.REQUEST, FROM PYPDF I IMPORTED PDFREADER, SQLITE3

# HOW TO RUN COODE:

#THE CODE IS RAN BY NAVIGATING TO THE CS5293SP23-PROJECT0/PROJECT0 FOLDER AND THEN RUNNING PIPENV RUN PYTHON MAIN.PY --INCIDENTS HTTPS://WWW.NORMANOK.GOV/SITES/DEFAULT/FILES/DOCUMENTS/2023-02/2023-02-22_DAILY_INCIDENT_SUMMARY.PDF.
 

# 

# cs5293sp23-project0
